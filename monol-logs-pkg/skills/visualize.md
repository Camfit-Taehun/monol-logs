---
description: 세션 시각화 - 타임라인, 대시보드, 통계
use_when:
  - 사용자가 "시각화", "대시보드", "타임라인" 등을 언급할 때
  - 세션 통계를 보고 싶을 때
  - 팀 활동을 시각적으로 확인하고 싶을 때
  - 세션 히스토리를 한눈에 보고 싶을 때
---

# /visualize - 세션 시각화

세션 활동을 시각화하여 타임라인, 통계, 대시보드를 생성합니다.

## 사용법

```
/visualize                      # 기본: 터미널 ASCII 타임라인
/visualize --ascii              # 터미널 ASCII 타임라인
/visualize --md                 # 마크다운 파일 생성
/visualize --html               # 인터랙티브 HTML 대시보드
/visualize --html --open        # 생성 후 브라우저에서 열기

# 필터링 옵션
/visualize --author <name>      # 특정 작성자만
/visualize --date 7d            # 최근 7일
/visualize --topic <search>     # 토픽 검색
```

## 인자: $ARGUMENTS

## 동작

### 1. 인자 파싱

- `--ascii`: 터미널 ASCII 출력 (기본값)
- `--md`: 마크다운 파일 생성
- `--html`: HTML 대시보드 생성
- `--author <name>`: 작성자 필터
- `--date <range>`: 날짜 필터 (`7d`, `30d`, `YYYY-MM-DD:YYYY-MM-DD`)
- `--topic <search>`: 토픽 검색
- `--output <path>`: 출력 경로 지정
- `--open`: 생성 후 자동 열기
- `--help` 또는 `-h`: 도움말

### 2. 세션 데이터 수집

`.claude/sessions/*.meta.json` 파일들을 스캔:

```bash
backup_dir=".claude/sessions"
sessions=()

for meta_file in "$backup_dir"/*.meta.json; do
  [[ -f "$meta_file" ]] || continue

  sessionId=$(jq -r '.sessionId' "$meta_file")
  topic=$(jq -r '.topic' "$meta_file")
  createdAt=$(jq -r '.createdAt' "$meta_file")
  savedAt=$(jq -r '.savedAt' "$meta_file")
  savedBy=$(jq -r '.savedBy' "$meta_file")
  messageCount=$(jq -r '.messageCount' "$meta_file")

  sessions+=("$sessionId|$topic|$createdAt|$savedAt|$savedBy|$messageCount")
done
```

### 3. 필터 적용

수집된 세션에 필터 적용:
- `--author`: savedBy 매칭
- `--date`: createdAt 범위 필터
- `--topic`: topic 부분 문자열 매칭

### 4. ASCII 출력 (--ascii / 기본)

터미널에 타임라인 출력:

```
Session Timeline
Generated: 2026-01-22
════════════════════════════════════════════════════════════════

Legend: @ alice  # bob  * charlie

2026-01-22 (Today)
├─ 14:30 ─────────────────────────────────── 16:45
│  @ ████████████ login-feature (42 msgs, f6702810)
│
└─ 09:15 ─────────────────────────────────── 11:30
   # ██████████ api-refactor (28 msgs, a1b2c3d4)

2026-01-21 (Yesterday)
├─ 15:00 ─────────────────────────────────── 17:30
│  * ██████████████ dashboard-fix (35 msgs, deadbeef)

════════════════════════════════════════════════════════════════
Summary: 3 sessions | 3 authors | 105 total messages
```

#### 4.1 작성자별 심볼/색상

```bash
SYMBOLS=("@" "#" "*" "+" "=" "&")
COLORS=("\033[34m" "\033[32m" "\033[35m" "\033[33m" "\033[36m" "\033[31m")

get_author_index() {
  local author="$1"
  local hash=$(echo "$author" | md5 | cut -c1-8)
  echo $((16#${hash} % 6))
}
```

#### 4.2 막대 길이 계산

- 시간 범위를 터미널 너비에 맞춤 (기본 60자)
- 메시지 수에 비례하여 막대 길이 조절

### 5. 마크다운 출력 (--md)

파일 생성: `.claude/sessions/visualization.md`

```markdown
# Session Visualization

Generated: {timestamp}
Total Sessions: {n} | Authors: {n} | Messages: {n}

## Timeline

| Date | Time | Author | Topic | Duration | Msgs | Links |
|------|------|--------|-------|----------|------|-------|
| 2026-01-22 | 14:30 | alice | login-feature | 2h 15m | 42 | [summary](./xxx.summary.md) |
| ... |

## Author Statistics

| Author | Sessions | Messages | Avg Duration |
|--------|----------|----------|--------------|
| alice | 12 | 520 | 2h 15m |
| bob | 8 | 312 | 1h 45m |

## Topic Distribution

| Topic | Sessions | Authors |
|-------|----------|---------|
| auth | 5 | alice, bob |
| api | 3 | bob |

---
*Generated by monol-logs /visualize*
```

### 6. HTML 대시보드 출력 (--html)

파일 생성: `.claude/sessions/dashboard.html`

#### 6.1 템플릿 복사 및 데이터 주입

```bash
template_path="$(dirname "$0")/../templates/dashboard.html"
output_path=".claude/sessions/dashboard.html"

# 세션 데이터를 JSON으로 변환
sessions_json=$(generate_sessions_json)

# 템플릿에 데이터 주입
sed "s|/\* SESSION_DATA_PLACEHOLDER \*/\[\]|$sessions_json|" "$template_path" > "$output_path"
```

#### 6.2 기능

템플릿 (`templates/dashboard.html`)에 포함된 기능:
- **필터링 UI**: 작성자, 날짜 범위, 토픽 검색
- **세션 카드 그리드**: 반응형 레이아웃
- **통계 요약**: 세션 수, 작성자 수, 총 메시지 수
- **다크/라이트 테마**: 토글 버튼
- **Insights 탭**: 팀 기여도, 지식 맵, TODO 현황

#### 6.3 자동 열기

`--open` 옵션 시:

```bash
if [[ "$OSTYPE" == "darwin"* ]]; then
  open "$output_path"
elif command -v xdg-open &>/dev/null; then
  xdg-open "$output_path"
else
  echo "브라우저에서 열어주세요: $output_path"
fi
```

### 7. 결과 출력

#### ASCII

터미널에 직접 출력

#### 마크다운

```
📄 Visualization saved:
   .claude/sessions/visualization.md

💡 팁: 마크다운 뷰어에서 열어보세요 (VS Code, Obsidian 등)
```

#### HTML

```
🌐 Dashboard generated:
   .claude/sessions/dashboard.html

💡 팁:
  - 브라우저에서 열어 인터랙티브 대시보드 확인
  - /visualize --html --open 으로 자동 열기
```

## 예시

```
/visualize
→ 터미널에 ASCII 타임라인 출력

/visualize --md
→ visualization.md 파일 생성

/visualize --html --open
→ dashboard.html 생성 후 브라우저에서 열기

/visualize --author alice --date 7d
→ alice의 최근 7일 세션만 시각화
```

## 관련 커맨드

- `/sessions` - 세션 목록 조회
- `/session view` - 세션 내용 보기
- `/insights` - 인사이트 분석
